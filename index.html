<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PJ-ECC Premium QR System</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Roboto:wght@300;400;900&display=swap" rel="stylesheet">
<script src="https://unpkg.com/html5-qrcode"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
<style>
:root{--pj-orange:#FF6A00;--pj-red:#FF3131;--bg-dark:#050505;}
body{margin:0;font-family:'Roboto',sans-serif;background:var(--bg-dark);color:#fff;overflow:hidden;}
.container{max-width:450px;width:90%;padding:25px;border-radius:30px;background:rgba(15,15,15,0.95);border:1px solid rgba(255,106,0,0.2);text-align:center;position:relative;}
.btn{border:none;border-radius:12px;padding:12px;font-weight:900;cursor:pointer;transition:0.3s;}
.btn-primary{background:linear-gradient(45deg,var(--pj-orange),var(--pj-red));color:#fff;}
.btn-primary:hover{box-shadow:0 0 20px var(--pj-orange);transform:scale(1.02);}
#menuBtn{position:absolute;top:15px;right:20px;font-size:26px;cursor:pointer;}
#menuPanel{position:absolute;top:50px;right:20px;background:#111;border-radius:10px;padding:10px;display:none;}
#menuPanel button{display:block;width:100%;margin:6px 0;}
canvas#holoCanvas{position:fixed;inset:0;z-index:-1;}
.bubble{position:absolute;bottom:-20px;width:6px;height:6px;background:var(--pj-orange);border-radius:50%;animation:bubble 6s linear infinite;}
@keyframes bubble{from{transform:translateY(0);opacity:1;}to{transform:translateY(-120vh);opacity:0;}}
#adminLockBox,#employeeBox,#qrCard{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);background:rgba(0,0,0,0.9);padding:25px;border-radius:25px;display:flex;flex-direction:column;align-items:center;}
#adminLockBox button,#employeeBox button,#qrCard button{margin-top:15px;width:80%;}
.tick{width:50px;height:50px;border-radius:50%;background:green;display:flex;align-items:center;justify-content:center;margin-bottom:15px;}
.tick:after{content:'✔';color:#fff;font-size:28px;}
select,input{margin:5px 0;padding:10px;width:100%;border-radius:10px;border:1px solid var(--pj-orange);background:#000;color:#fff;}
</style>
</head>
<body>
<canvas id="holoCanvas"></canvas>

<div class="container">
  <h1 style="font-family:'Orbitron';color:var(--pj-orange)">PJ-ECC</h1>
  <p>Premium QR Verification System<br>Scan, verify, track expiry & purpose.</p>
  <div id="menuBtn">⋮</div>
  <div id="menuPanel">
    <button onclick="toggleMute()">Mute</button>
    <button onclick="toggleTheme()">Light / Dark</button>
    <button onclick="toggleCyber()">Cyber Mode</button>
    <button onclick="showChangeLog()">What's New?</button>
  </div>
  <div id="scanner">
    <button class="btn-primary" onclick="startScan()">Start Scan</button>
    <button class="btn-primary" onclick="scanGallery()">Scan from Gallery</button>
  </div>
</div>

<!-- Admin Lock -->
<div id="adminLockBox">
  <div class="tick"></div>
  <p>Enter Admin Key:</p>
  <input type="password" id="adminKey" placeholder="Admin Key">
  <button class="btn-primary" onclick="unlockAdmin()">Unlock</button>
</div>

<!-- Employee Detail Setup -->
<div id="employeeBox" style="display:none;">
  <p>Employee Details</p>
  <input id="empName" placeholder="Employee Name">
  <input id="empRef" placeholder="Reference ID">
  <select id="empPurpose">
    <option value="ENTRY">ENTRY</option>
    <option value="VISITOR">VISITOR</option>
    <option value="TEMP">TEMP</option>
    <option value="AUDIT">AUDIT</option>
  </select>
  <input type="datetime-local" id="empExpiry">
  <button class="btn-primary" onclick="generateToken()">Generate QR</button>
</div>

<!-- QR Card Popup -->
<div id="qrCard" style="display:none;">
  <p id="qrEmpName"></p>
  <p id="qrEmpPurpose"></p>
  <p id="qrEmpRef"></p>
  <p id="qrEmpExpiry"></p>
  <div id="qrCode"></div>
  <button class="btn-primary" onclick="closeCard()">Close</button>
</div>

<audio id="beep"><source src="data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEAESsAACJWAAACABAAZGF0YQAAAAA="></audio>
<audio id="adminBeep"><source src="data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEAESsAACJWAAACABAAZGF0YQAAAAA="></audio>

<script>
/* ---------------- HOLOGRAPHIC BG ---------------- */
const canvas=document.getElementById('holoCanvas'),ctx=canvas.getContext('2d');
function resizeCanvas(){canvas.width=innerWidth;canvas.height=innerHeight;}
window.addEventListener('resize',resizeCanvas);resizeCanvas();
let particles=[];for(let i=0;i<120;i++){particles.push({x:Math.random()*canvas.width,y:Math.random()*canvas.height,r:Math.random()*2+1,dx:(Math.random()-0.5)*0.5,dy:(Math.random()-0.5)*0.5});}
function draw(){ctx.clearRect(0,0,canvas.width,canvas.height);for(let p of particles){ctx.beginPath();ctx.arc(p.x,p.y,p.r,0,2*Math.PI);ctx.fillStyle=`rgba(255,106,0,0.2)`;ctx.fill();p.x+=p.dx;p.y+=p.dy;if(p.x>canvas.width)p.x=0;if(p.x<0)p.x=canvas.width;if(p.y>canvas.height)p.y=0;if(p.y<0)p.y=canvas.height;}}
setInterval(draw,33);
setInterval(()=>{const b=document.createElement('div');b.className='bubble';b.style.left=Math.random()*100+'vw';document.body.appendChild(b);setTimeout(()=>b.remove(),6000);},600);

/* ---------------- MENU ---------------- */
const menuBtn=document.getElementById('menuBtn'),menuPanel=document.getElementById('menuPanel');
menuBtn.onclick=()=>{menuPanel.style.display=menuPanel.style.display==='block'?'none':'block';};
let muted=false,cyberOn=true;
function toggleMute(){muted=!muted;}
function toggleTheme(){document.body.classList.toggle('light');}
function toggleCyber(){cyberOn=!cyberOn;canvas.style.display=cyberOn?'block':'none';}

/* ---------------- ADMIN UNLOCK ---------------- */
function unlockAdmin(){
  const key=document.getElementById('adminKey').value;
  if(key==='sonu@admin'){ // demo key
    document.getElementById('adminLockBox').style.display='none';
    document.getElementById('employeeBox').style.display='flex';
    if(!muted)document.getElementById('adminBeep').play();
    alert("✅ Admin unlocked! Proceed to employee setup.");
  } else alert("❌ Wrong Key");
}

/* ---------------- GENERATE TOKEN ---------------- */
function generateToken(){
  const name=document.getElementById('empName').value.trim();
  const ref=document.getElementById('empRef').value.trim();
  const purpose=document.getElementById('empPurpose').value;
  const expiry=document.getElementById('empExpiry').value;
  if(!name||!ref||!expiry){alert("Fill all details"); return;}
  const token={name,purpose,ref,expiry};
  showCard(token);
}

/* ---------------- SHOW QR CARD ---------------- */
function showCard(data){
  document.getElementById('qrEmpName').textContent="Name: "+data.name;
  document.getElementById('qrEmpPurpose').textContent="Purpose: "+data.purpose;
  document.getElementById('qrEmpRef').textContent="Ref: "+data.ref;
  document.getElementById('qrEmpExpiry').textContent="Expires: "+data.expiry;
  const qrDiv=document.getElementById('qrCode'); qrDiv.innerHTML="";
  new QRCode(qrDiv,{text:JSON.stringify(data),width:180,height:180});
  document.getElementById('qrCard').style.display='flex';
  if(!muted)document.getElementById('beep').play();
}
function closeCard(){document.getElementById('qrCard').style.display='none';}

/* ---------------- SCAN PLACEHOLDER ---------------- */
function startScan(){alert("Camera scan starts (placeholder)"); if(!muted)document.getElementById('beep').play();}
function scanGallery(){alert("Gallery scan placeholder");}

/* ---------------- CHANGE LOG ---------------- */
function showChangeLog(){alert("PJ-ECC Update Log:\n- Premium QR animation\n- Admin lock with tick & beep\n- Employee detail setup\n- Holographic background\n- Scan expiry & purpose tracking");}

/* ---------------- SECURITY HARDENING ---------------- */
document.onkeydown=e=>{if(e.key==="F12"|| (e.ctrlKey&&e.shiftKey)) e.preventDefault();};
</script>
</body>
</html>
